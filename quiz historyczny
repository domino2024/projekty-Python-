from flask import Flask, request, session, redirect
import random

app = Flask(__name__)
app.secret_key = 'tajny_klucz_balkanski'
questions_pool = [
{
    'type': 'text',
    'question': 'Kt√≥re miasto by≈Ço celem masakry na rynku Markale w 1994 roku?',
    'options': ['Sarajewo', 'Mostar', 'Banja Luka', 'Tuzla'],
    'answer': 'Sarajewo',
    'explanation': 'Masakra na rynku Markale w Sarajewie by≈Ça jednym z najtragiczniejszych wydarze≈Ñ oblƒô≈ºenia ‚Äì zginƒô≈Ço 68 os√≥b.'
},
{
    'type': 'text',
    'question': 'Kto by≈Ç prezydentem Chorwacji podczas wojny w latach 1991‚Äì1995?',
    'options': ['Franjo Tuƒëman', 'Slobodan Milo≈°eviƒá', 'Alija Izetbegoviƒá', 'Radovan Karad≈æiƒá'],
    'answer': 'Franjo Tuƒëman',
    'explanation': 'Franjo Tuƒëman by≈Ç pierwszym prezydentem niepodleg≈Çej Chorwacji i przyw√≥dcƒÖ w czasie wojny.'
},
{
    'type': 'text',
    'question': 'Jak nazywa≈Ç siƒô plan pokojowy z 1992 roku, kt√≥ry zak≈Çada≈Ç podzia≈Ç Bo≈õni na kantony?',
    'options': ['Plan Vance-Owen', 'Plan Dayton', 'Plan Z-4', 'Plan Kumanovo'],
    'answer': 'Plan Vance-Owen',
    'explanation': 'Plan Vance-Owen zak≈Çada≈Ç podzia≈Ç Bo≈õni na 10 kanton√≥w etnicznych, ale zosta≈Ç odrzucony przez Serb√≥w.'
},
{
    'type': 'text',
    'question': 'Kto by≈Ç g≈Ç√≥wnodowodzƒÖcym NATO podczas nalot√≥w na Serbiƒô w 1999 roku?',
    'options': ['Wesley Clark', 'James Mattis', 'Colin Powell', 'Javier Solana'],
    'answer': 'Wesley Clark',
    'explanation': 'Genera≈Ç Wesley Clark by≈Ç dow√≥dcƒÖ si≈Ç NATO podczas operacji Allied Force.'
},
{
    'type': 'text',
    'question': 'Kt√≥ry kraj przyjƒÖ≈Ç najwiƒôcej uchod≈∫c√≥w z Bo≈õni i Hercegowiny podczas wojny?',
    'options': ['Niemcy', 'Szwecja', 'Chorwacja', 'Turcja'],
    'answer': 'Niemcy',
    'explanation': 'Niemcy przyjƒô≈Çy setki tysiƒôcy uchod≈∫c√≥w z Bo≈õni w latach 90.'
},
{
    'type': 'text',
    'question': 'Kt√≥ry przyw√≥dca by≈Ç oskar≈ºony o zbrodnie przeciwko ludzko≈õci i zmar≈Ç w Hadze?',
    'options': ['Slobodan Milo≈°eviƒá', 'Radovan Karad≈æiƒá', 'Ratko Mladiƒá', 'Franjo Tuƒëman'],
    'answer': 'Slobodan Milo≈°eviƒá',
    'explanation': 'Slobodan Milo≈°eviƒá zmar≈Ç w celi w Hadze w 2006 roku, zanim zapad≈Ç wyrok w jego sprawie.'
},
{
    'type': 'text',
    'question': 'JakƒÖ nazwƒô nosi≈Ça serbska formacja paramilitarna znana z brutalnych dzia≈Ça≈Ñ?',
    'options': ['Tygrysy Arkana', 'B≈Çƒôkitne He≈Çmy', 'HVO', 'U√áK'],
    'answer': 'Tygrysy Arkana',
    'explanation': 'Tygrysy Arkana, dowodzone przez ≈Ωeljko Ra≈ænatoviƒáa, by≈Çy odpowiedzialne za liczne zbrodnie wojenne.'
},
{
    'type': 'text',
    'question': 'Jakie miasto by≈Ço stolicƒÖ samozwa≈Ñczej Republiki Serbskiej Krajiny?',
    'options': ['Knin', 'Banja Luka', 'Split', 'Dubrovnik'],
    'answer': 'Knin',
    'explanation': 'Knin by≈Ço stolicƒÖ serbskiego separatystycznego tworu w Chorwacji ‚Äì Republiki Serbskiej Krajiny.'
},
{
    'type': 'text',
    'question': 'Jak nazywa≈Ç siƒô kontyngent ONZ stacjonujƒÖcy w Bo≈õni podczas wojny?',
    'options': ['UNPROFOR', 'KFOR', 'ISAF', 'SFOR'],
    'answer': 'UNPROFOR',
    'explanation': 'UNPROFOR (United Nations Protection Force) by≈Ç si≈Çami pokojowymi ONZ obecnymi w Bo≈õni w latach 1992‚Äì1995.'
},

    {
        'type': 'text',
        'question': 'W kt√≥rym roku rozpoczƒô≈Ça siƒô wojna w Bo≈õni i Hercegowinie?',
        'options': ['1992', '1989', '1995', '2001'],
        'answer': '1992',
        'explanation': 'Wojna w Bo≈õni rozpoczƒô≈Ça siƒô w 1992 roku i trwa≈Ça do 1995. Zginƒô≈Ço ponad 100 tys. os√≥b.'
    },
    {
        'type': 'text',
        'question': 'Jakie miasto by≈Ço oblƒô≈ºone przez ponad 1400 dni?',
        'options': ['Sarajewo', 'Belgrad', 'Zagrzeb', 'Mostar'],
        'answer': 'Sarajewo',
        'explanation': 'Oblƒô≈ºenie Sarajewa by≈Ço najd≈Çu≈ºszym oblƒô≈ºeniem stolicy we wsp√≥≈Çczesnej Europie (1992‚Äì1996).'
    },
    {
        'type': 'text',
        'question': 'W kt√≥rej miejscowo≈õci mia≈Ça miejsce masakra ponad 8000 Bo≈õniak√≥w?',
        'options': ['Srebrenica', 'Sarajewo', 'Prijedor', 'Vukovar'],
        'answer': 'Srebrenica',
        'explanation': 'W lipcu 1995 w Srebrenicy zamordowano ponad 8000 muzu≈Çma≈Ñskich mƒô≈ºczyzn i ch≈Çopc√≥w.'
    },
    {
        'type': 'text',
        'question': 'Kt√≥re pa≈Ñstwo jako pierwsze og≈Çosi≈Ço niepodleg≈Ço≈õƒá od Jugos≈Çawii?',
        'options': ['S≈Çowenia', 'Chorwacja', 'Bo≈õnia i Hercegowina', 'Kosowo'],
        'answer': 'S≈Çowenia',
        'explanation': 'S≈Çowenia og≈Çosi≈Ça niepodleg≈Ço≈õƒá 25 czerwca 1991 roku.'
    },
    {
        'type': 'text',
        'question': 'Kt√≥ra armia dopu≈õci≈Ça siƒô oblƒô≈ºenia Vukovaru?',
        'options': ['Jugos≈Çowia≈Ñska Armia Ludowa (JNA)', 'NATO', 'Armia Chorwacka', 'Arkanowcy'],
        'answer': 'Jugos≈Çowia≈Ñska Armia Ludowa (JNA)',
        'explanation': 'JNA i si≈Çy serbskie zniszczy≈Çy chorwacki Vukovar w 1991 roku po 87 dniach oblƒô≈ºenia.'
    },
    {
        'type': 'text',
        'question': 'Kt√≥ra organizacja zbombardowa≈Ça Serbiƒô w 1999?',
        'options': ['NATO', 'ONZ', 'UE', 'OBWE'],
        'answer': 'NATO',
        'explanation': 'NATO przeprowadzi≈Ço naloty na Serbiƒô bez mandatu ONZ w odpowiedzi na konflikt w Kosowie.'
    },
    {
        'type': 'flag',
        'image': 'https://flagcdn.com/w320/rs.png',
        'question': 'Czyja to flaga?',
        'options': ['Serbia', 'Bu≈Çgaria', 'Chorwacja', 'S≈Çowenia'],
        'answer': 'Serbia',
        'explanation': 'To flaga Serbii ‚Äì czerwono-niebiesko-bia≈Ça z herbem.'
    },
    {
        'type': 'flag',
        'image': 'https://flagcdn.com/w320/ba.png',
        'question': 'Czyja to flaga?',
        'options': ['Bo≈õnia i Hercegowina', 'Albania', 'Kosowo', 'Macedonia P√≥≈Çnocna'],
        'answer': 'Bo≈õnia i Hercegowina',
        'explanation': 'Flaga Bo≈õni ma niebieskie t≈Ço, ≈º√≥≈Çty tr√≥jkƒÖt i bia≈Çe gwiazdki.'
    },
    {
        'type': 'text',
        'question': 'Kiedy podpisano Porozumienie w Dayton, kt√≥re zako≈Ñczy≈Ço wojnƒô w Bo≈õni?',
        'options': ['1995', '1992', '1998', '1990'],
        'answer': '1995',
        'explanation': 'Porozumienie w Dayton podpisano w 1995 roku.'
    },
    {
        'type': 'text',
        'question': 'Ile dni trwa≈Ço oblƒô≈ºenie Sarajewa?',
        'options': ['1425', '800', '1000', '1200'],
        'answer': '1425',
        'explanation': 'Oblƒô≈ºenie Sarajewa trwa≈Ço 1425 dni, czyli oko≈Ço 3,9 roku.'
    },
    {
        'type': 'text',
        'question': 'Jaki region by≈Ç g≈Ç√≥wnym powodem konfliktu miƒôdzy SerbiƒÖ a Kosowem?',
        'options': ['Kosowo', 'Wojwodina', 'Krajina', 'Sand≈ºak'],
        'answer': 'Kosowo',
        'explanation': 'Kosowo by≈Ço regionem autonomicznym, kt√≥ry og≈Çosi≈Ç niepodleg≈Ço≈õƒá od Serbii w 2008 roku, co by≈Ço powodem konfliktu i interwencji NATO.'
    }
]

# ‚Üê Tu umie≈õƒá questions_pool (Tw√≥j ca≈Çy zestaw pyta≈Ñ z flagami i tekstami)

# (Dla oszczƒôdno≈õci miejsca pomi≈Ñmy tu questions_pool ‚Äì masz go ju≈º z poprzednich wiadomo≈õci)

def html_template(content):
    return f"""<!DOCTYPE html>
<html>
<head>
    <title>Quiz o Ba≈Çkanach</title>
    <style>
        body {{
            font-family: 'Courier New', monospace;
            background: linear-gradient(to bottom,
                #002f6c 0%, #002f6c 33.33%,
                #ffffff 33.34%, #ffffff 66.66%,
                #d62828 66.67%, #d62828 100%);
            min-height: 100vh;
            margin: 0;
            padding: 40px;
        }}
        .card {{
            background: white;
            max-width: 800px;
            margin: auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1;
        }}
        h1, h2 {{
            text-align: center;
            font-weight: bold;
            letter-spacing: 1px;
        }}
        button {{
            background-color: #4b5320;
            color: #f2f2f2;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid #2f3b12;
            padding: 12px 24px;
            border-radius: 4px;
            box-shadow: 2px 2px 0 #2f3b12;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }}
        button:hover {{
            background-color: #3e4421;
            box-shadow: none;
            transform: translate(1px, 1px);
        }}
        img.flag {{
            width: 100%;
            max-width: 300px;
            display: block;
            margin: 20px auto;
            border: 1px solid #ccc;
        }}
        .correct {{ color: green; }}
        .incorrect {{ color: red; }}
        em {{
            display: block;
            margin-top: 10px;
            font-style: italic;
            color: #555;
        }}
        textarea {{
            width: 100%;
            height: 100px;
            margin-top: 20px;
            font-family: monospace;
            padding: 10px;
        }}
    </style>
</head>
<body>
<div class="card">
{content}
</div>
</body>
</html>"""

@app.route('/')
def index():
    session['questions'] = random.sample(questions_pool, 10)
    session['current'] = 0
    session['score'] = 0
    session['answers'] = []
    return html_template('''
        <h1>üî• Cienie Wojny: Ba≈Çkany w Ogniu</h1>
        <p style="text-align:center; font-weight:bold; font-size: 1.2em;">
            Upadek Jugos≈Çawii przyni√≥s≈Ç chaos, cierpienie i zbrodnie, kt√≥re wstrzƒÖsnƒô≈Çy ≈õwiatem.<br>
            Czy znasz prawdƒô o najbardziej krwawym konflikcie w Europie po II wojnie ≈õwiatowej?
        </p>
        <form action="/quiz" method="get" style="text-align:center; margin-top: 30px;">
            <button type="submit">Rozpocznij quiz</button>
        </form>
        <p style="text-align:center; margin-top: 20px;">
            <a href="/ciekawostki"><button>üìö Ciekawostki o wojnie</button></a>
        </p>
    ''')

@app.route('/quiz', methods=['GET', 'POST'])
def quiz():
    feedback = ""
    if request.method == 'POST':
        selected = request.form.get('answer')
        current = session['current']
        question = session['questions'][current - 1]
        correct = session['correct_answer']
        explanation = session['explanation']
        session['answers'].append((question['question'], selected, correct))
        if selected == correct:
            session['score'] += 1
            feedback = f"<p class='correct'><strong>Dobrze!</strong></p><em>{explanation}</em>"
        else:
            feedback = f"<p class='incorrect'><strong>Niepoprawnie.</strong></p><em>{explanation}</em>"

    current = session['current']
    if current >= len(session['questions']):
        return redirect('/result')

    question = session['questions'][current]
    session['current'] += 1

    shuffled_options = question['options'][:]
    random.shuffle(shuffled_options)
    session['correct_answer'] = question['answer']
    session['explanation'] = question.get('explanation', '')

    img_html = f'<img src="{question["image"]}" class="flag">' if question['type'] == 'flag' else ""

    options_html = ''.join(
        f'<label><input type="radio" name="answer" value="{opt}" required> {opt}</label><br>'
        for opt in shuffled_options
    )

    return html_template(f'''
        <h2>Pytanie {current} z {len(session['questions'])}</h2>
        {feedback}
        {img_html}
        <form method="post">
            <p><strong>{question["question"]}</strong></p>
            {options_html}
            <button type="submit">Dalej</button>
        </form>
    ''')

@app.route('/result', methods=['GET', 'POST'])
def result():
    if request.method == 'POST':
        opinia = request.form.get('opinia', '').strip()
        if opinia:
            with open('opinie.txt', 'a', encoding='utf-8') as f:
                f.write(f"{opinia}\n---\n")
    answers = session.get('answers', [])
    score = session.get('score', 0)
    html = f"<h1>Tw√≥j wynik: {score} / {len(answers)}</h1><ul>"
    for q, user, correct in answers:
        css = 'correct' if user == correct else 'incorrect'
        html += f"<li><strong>{q}</strong><br>Twoja odpowied≈∫: <span class='{css}'>{user}</span><br>Poprawna: {correct}</li><br>"
    html += "</ul><hr><h2>üó£Ô∏è Podziel siƒô opiniƒÖ</h2>"
    html += '''
        <form method="post">
            <textarea name="opinia" placeholder="Napisz, co sƒÖdzisz o quizie..."></textarea><br>
            <button type="submit">Wy≈õlij opiniƒô</button>
        </form>
        <p style="text-align:center; margin-top: 20px;">
            <a href="/"><button>Zagraj ponownie</button></a>
        </p>
    '''
    return html_template(html)


@app.route('/ciekawostki')
def ciekawostki():
    content = """
    <h1>üß† Ciekawostki o wojnie w Jugos≈Çawii</h1>
    <ul>
        <li><strong>Rozpad Jugos≈Çawii</strong> rozpoczƒÖ≈Ç siƒô w 1991 roku, gdy S≈Çowenia i Chorwacja og≈Çosi≈Çy niepodleg≈Ço≈õƒá od federacji.</li><br>
        <li><strong>Wojna w Bo≈õni</strong> by≈Ça najkrwawszym konfliktem w Europie po II wojnie ≈õwiatowej ‚Äì zginƒô≈Ço ponad 100 000 os√≥b, w tym wielu cywil√≥w.</li><br>
        <li><strong>Masakra w Srebrenicy</strong> w 1995 roku zosta≈Ça uznana przez ONZ za akt ludob√≥jstwa ‚Äì zginƒô≈Ço ponad 8000 bo≈õniackich muzu≈Çman√≥w.</li><br>
        <li><strong>Oblƒô≈ºenie Sarajewa</strong> trwa≈Ço 1425 dni ‚Äì by≈Ço to najd≈Çu≈ºsze oblƒô≈ºenie stolicy w historii nowoczesnej Europy.</li><br>
        <li><strong>NATO</strong> przeprowadzi≈Ço bombardowania Serbii w 1999 roku (Operacja Allied Force) bez zgody Rady Bezpiecze≈Ñstwa ONZ.</li><br>
        <li><strong>Slobodan Milo≈°eviƒá</strong> by≈Ç pierwszym by≈Çym prezydentem, kt√≥ry stanƒÖ≈Ç przed Miƒôdzynarodowym Trybuna≈Çem Karnym (zmar≈Ç przed og≈Çoszeniem wyroku).</li><br>
        <li><strong>Jugos≈Çawia</strong> oznacza "Kraina Po≈Çudniowych S≈Çowian" i istnia≈Ça od 1918 do 2003 roku (w r√≥≈ºnych formach politycznych).</li><br>
        <li><strong>Trybuna≈Ç ICTY</strong> w Hadze oskar≈ºy≈Ç ponad 160 os√≥b o zbrodnie wojenne, w tym genera≈Ç√≥w, polityk√≥w i bojownik√≥w.</li><br>
        <li><strong>Wojna w Chorwacji</strong> (1991‚Äì1995) rozpoczƒô≈Ça siƒô od ataku wojsk JNA i serbskich paramilitarnych na Vukovar.</li><br>
        <li><strong>Mostar</strong> by≈Ç symbolem konfliktu ‚Äì historyczny Stary Most zosta≈Ç zniszczony w 1993 roku i odbudowany dopiero w 2004.</li><br>
        <li><strong>Kosowo</strong> og≈Çosi≈Ço niepodleg≈Ço≈õƒá w 2008 roku, ale Serbia i kilka innych pa≈Ñstw jej nie uznaje do dzi≈õ.</li><br>
        <li><strong>Albania</strong> odegra≈Ça istotnƒÖ rolƒô jako zaplecze logistyczne dla Alba≈Ñczyk√≥w z Kosowa w konflikcie z SerbiƒÖ.</li><br>
        <li><strong>Radovan Karad≈æiƒá</strong>, przyw√≥dca bo≈õniackich Serb√≥w, zosta≈Ç skazany na do≈ºywocie za zbrodnie wojenne.</li><br>
        <li><strong>Republika Serbska</strong> to autonomiczna jednostka w Bo≈õni i Hercegowinie powsta≈Ça w wyniku Porozumienia z Dayton.</li><br>
        <li><strong>Krajina</strong> ‚Äì region zamieszkany przez Serb√≥w w Chorwacji ‚Äì by≈Ç miejscem walk i czystek etnicznych z obu stron.</li><br>
        <li><strong>‚ÄûEtno-kampanie‚Äù</strong> prowadzone przez strony konfliktu polega≈Çy na wypƒôdzaniu ca≈Çych spo≈Çeczno≈õci z dom√≥w ze wzglƒôdu na narodowo≈õƒá.</li>
    </ul>
    <p style="text-align:center;">
        <a href="/"><button>Powr√≥t do strony g≈Ç√≥wnej</button></a>
    </p>
    """
    return html_template(content)


if __name__ == '__main__':
    app.run(debug=True)
